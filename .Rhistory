legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0),
limits = c(0,1)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,1)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(1,0)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
mechnsev
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
# scale_y_continuous(expand = c(0,0),
#                    limits = c(0,325)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0),
limits = c(0,1.1)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0),
limits = c(0,325)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0),
limits = c(0,2)) +
xlab("Impact severity") +
ylab("Number of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
# scale_y_continuous(expand = c(0,0),
#                    limits = c(0,325)) +
xlab("Impact severity") +
ylab("Proportion of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(
limits = c(0,1)) +
xlab("Impact severity") +
ylab("Proportion of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderMech, aes(x = reorder(Mechanism, NumStudies, function(x) -sum(x)), y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity") +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Impact mechanism") +
ylab("Proportion of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
ggplot(OrderMech, aes(x = reorder(Order, NumStudies, function(x) -sum(x)), y = NumStudies)) +
geom_bar(aes(Mechanism), position = "fill", stat = "identity") +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "top")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Taxonomic order") +
ylab("Number of impact studies") +
scale_fill_manual("Impact\nmechanism",values = rev(pnw_palette("Lake", 13)))
ggplot(OrderMech, aes(x = reorder(Order, NumStudies, function(x) -sum(x)), y = NumStudies)) +
geom_bar(aes(fill = Mechanism), position = "fill", stat = "identity") +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "top")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Taxonomic order") +
ylab("Number of impact studies") +
scale_fill_manual("Impact\nmechanism",values = rev(pnw_palette("Lake", 13)))
comp1 <- ggplot(OrderMech, aes(x = reorder(Mechanism, NumStudies, function(x) -sum(x)), y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity") +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Impact mechanism") +
ylab("Proportion of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
comp3 <- ggplot(OrderMech, aes(x = reorder(Order, NumStudies, function(x) -sum(x)), y = NumStudies)) +
geom_bar(aes(fill = Mechanism), position = "fill", stat = "identity") +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "top")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Taxonomic order") +
ylab("Proportion of impact studies") +
scale_fill_manual("Impact\nmechanism",values = rev(pnw_palette("Lake", 13)))
comp2 <- ggplot(OrderSev, aes(x = Severity, y = NumStudies)) +
geom_bar(aes(fill = Order),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "right")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Impact severity") +
ylab("Proportion of impact studies") +
scale_fill_manual("Taxonomic\norder", values = pnw_palette("Bay", 13))
comp4 <- ggplot(MechSeverity, aes(x = Severity, y = NumStudies, fill = Mechanism)) +
geom_bar(aes(fill = Mechanism),position = "fill", stat = "identity", width = 0.4) +
theme_bw() +
theme(axis.text.y = element_text(colour = "black", size = 14),
axis.text.x = element_text(colour = "black", size = 14, angle = 90, vjust = 0.5),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.position = "top")+#,
#plot.margin = unit(c(1,1,1,1), "cm")) +
scale_y_continuous(expand = c(0,0)) +
xlab("Impact severity") +
ylab("Proportion of impact studies") +
scale_fill_manual("Impact\nmechanism", values = rev(pnw_palette("Lake", 13)))
AB <- ggarrange(comp1, comp2, common.legend = T, legend = "left", ncol = 1, nrow = 2, labels = c("A","C"))
CD <- ggarrange(comp3, comp4, common.legend = T, legend = "right",ncol = 1, nrow = 2, labels = c("B","D"))
mechnsev <- ggarrange(AB, CD, common.legend = F, ncol = 2, nrow = 1)
mechnsev
source("R/10.impact_confidence.R")
??MCA
install.packages("FactoMineR")
# Confidence
conf_plot <- ggplot(Impacts.nonDD, aes(x = Confidence, fill = Confidence)) +
geom_bar(width = .5) +
scale_fill_manual(values = c("Low" = "#00AFBB", "Medium" = "#E7B800", "High"="#FC4E07")) +
scale_y_continuous(expand = c(0,0),
limits = c(0,400)) +
theme_bw() +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14)) +
ylab("Frequency")
conf_plot
#Minimum set
minset <- Impacts.nonDD %>% dplyr::select(`Order`, `Mechanism`, `Severity`, `Confidence`)
#Multiple correspondence analysis
minsetMCA <- MCA(minset, graph = F)
library(FactoMineR)
#Multiple correspondence analysis
minsetMCA <- MCA(minset, graph = F)
catMCA <- fviz_mca_var(minsetMCA, col.var = "cos2",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE, # avoid text overlapping (slow)
ggtheme = theme_minimal(),
title = "")
install.packages("factoextra")
library(factoextra)
catMCA <- fviz_mca_var(minsetMCA, col.var = "cos2",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE, # avoid text overlapping (slow)
ggtheme = theme_minimal(),
title = "")
indMCA <- fviz_mca_ind(minsetMCA,
label = "none", # hide individual labels
habillage = "Confidence", # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07"),
addEllipses = TRUE, ellipse.type = "confidence", #confidence ellipse around mean point
ggtheme = theme_minimal(),
title = "")
catMCA
indMCA
fviz_mca_ind(minsetMCA,
label = "none", # hide individual labels
habillage = "Confidence", # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07"),
addEllipses = TRUE, ellipse.type = "confidence", #confidence ellipse around mean point
ggtheme = theme_minimal(),
title = "")
?fviz_mca_ind
minsetMCA
minsetMCA$var$coord
minset$Confidence
fviz_mca_ind(minsetMCA,
label = "none", # hide individual labels
habillage = minset$Confidence, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07"),
addEllipses = TRUE, ellipse.type = "confidence", #confidence ellipse around mean point
ggtheme = theme_minimal(),
title = "")
is.factor(minset$Confidence)
fviz_mca_ind(minsetMCA,
label = "none", # hide individual labels
habillage = minset$Confidence, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07"),
addEllipses = F, ellipse.type = "confidence", #confidence ellipse around mean point
ggtheme = theme_minimal(),
title = "")
glm(Number ~ factor(Order) + factor(Assessed), data = Order_assessed, family = poisson)
##log-linear analysis
Order_assessed <- species_assessed_min %>%
dplyr::select(Order, Evidence, DataDeficient) %>%
rename(NotDD = "Evidence") %>%
rename(DD = "DataDeficient") %>%
gather(key = "Assessed", value = "Number", -Order)
load(file.path("lvl_0.RData"))
file.path()
library(here)
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_0.RData"))
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_1.RData"))
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_0.RData"))
lvl_0_sf <- st_as_sf(lvl_0)
lvl_0_sf <- st_transform(lvl_0_sf, crs = "+proj=moll") #Mollweide projection
rm(lvl_0)
lvl_1_sf <- st_as_sf(lvl_1)
lvl_1_sf <- st_transform(lvl_1_sf, crs = "+proj=moll") #Mollweide projection
rm(lvl_1)
source("R/2.data_preparation.R")
#Load required libraries and data
#~# Clears the environment
rm(list=ls())
#~# Load impact data
Pool <- read_excel(file.path("Data", "Species_pool.xlsx"),
sheet = "Pool")
Literature <- read_excel(file.path("Data", "Assessment_information.xlsx"),
sheet = "Literature_searches")
Impacts <- read_excel(file.path("Data", "Assessment_information.xlsx"),
sheet = "Assessment_results_input")
Impact_Distribution <- read_excel(file.path("Data", "Assessment_information.xlsx"),
sheet = "Impact_distribution")
Insect_Distribution <- read.csv(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts","GRIIS - Country Compendium V1_0.csv")) %>%
filter(class == "Insecta")
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_0.RData"))
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_1.RData"))
lvl_0_sf <- st_as_sf(lvl_0)
lvl_0_sf <- st_transform(lvl_0_sf, crs = "+proj=moll") #Mollweide projection
rm(lvl_0)
lvl_1_sf <- st_as_sf(lvl_1)
lvl_1_sf <- st_transform(lvl_1_sf, crs = "+proj=moll") #Mollweide projection
rm(lvl_1)
source("R/2.data_preparation.R")
#Load required libraries and data
#~# Clears the environment
rm(list=ls())
p <- here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts/high-seas-master/geo-data/XYPorts_CM_Cruse_anchorage_world2_final.shp")
ports <- st_read(p)
ports_country <- ports %>%
group_by(ISO3166A3) %>%
summarise(length(LOCODE)) %>%
st_drop_geometry()
#~# Load impact data
Pool <- read_excel(file.path("Data", "Species_pool.xlsx"),
sheet = "Pool")
Literature <- read_excel(file.path("Data", "Assessment_information.xlsx"),
sheet = "Literature_searches")
Impacts <- read_excel(file.path("Data", "Assessment_information.xlsx"),
sheet = "Assessment_results_input")
Impact_Distribution <- read_excel(file.path("Data", "Assessment_information.xlsx"),
sheet = "Impact_distribution")
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_0.RData"))
load(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts", "lvl_1.RData"))
Insect_Distribution <- read.csv(here("C:/Users/daclarke@ltu.edu.au/Documents/projects/insect_impacts","GRIIS - Country Compendium V1_0.csv")) %>%
filter(class == "Insecta")
lvl_0_sf <- st_as_sf(lvl_0)
lvl_0_sf <- st_transform(lvl_0_sf, crs = "+proj=moll") #Mollweide projection
rm(lvl_0)
lvl_1_sf <- st_as_sf(lvl_1)
lvl_1_sf <- st_transform(lvl_1_sf, crs = "+proj=moll") #Mollweide projection
rm(lvl_1)
source("R/2.data_preparation.R")
glm(Number ~ factor(Order) + factor(Assessed), data = Order_assessed, family = poisson)
##log-linear analysis
Order_assessed <- species_assessed_min %>%
dplyr::select(Order, Evidence, DataDeficient) %>%
rename(NotDD = "Evidence") %>%
rename(DD = "DataDeficient") %>%
gather(key = "Assessed", value = "Number", -Order)
glm(Number ~ factor(Order) + factor(Assessed), data = Order_assessed, family = poisson)
fit.1 <- glm(Number ~ factor(Order) * factor(Assessed), data = Order_assessed, family = poisson)
fit.2 <- glm(Number ~ factor(Order) + factor(Assessed), data = Order_assessed, family = poisson)
pchisq(deviance(fit.2), df = df.residual(fit.2), lower.tail = F)
summary(fit.2)
#reject the null that the cell frequencies satisfy the given loglinear model
anova(fit.2, test = "Chisq")
anova(fit.2, fit.1, test = "Chisq")
summary(fit.1)
summary(fit.2)
exp(-0.5235)
fit.2$coefficients
fit.2$coefficients[12]
fit.2$coefficients[19]
exp(fit.2$coefficients[19])
# the estimated odds ratio for any given taxonomic order having evidence of
# environmental impact, relative to being data deficient, was significant.
exp(fit.2$coefficients[19])
gc()
